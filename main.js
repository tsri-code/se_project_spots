!function(){"use strict";function e(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Save",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Saving...";e.textContent=t?o:r}const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-btn",disabledButtonClass:"modal__submit-btn_disabled",inputErrorClass:"modal__input_type_error",activeErrorClass:"modal__error_visible"},r=(e,t,r)=>{const o=e.querySelector(`#${t.id}-error`);t.classList.remove(r.inputErrorClass),o.textContent=""},o=(e,t,r)=>{(e=>Array.from(e).some((e=>!e.validity.valid)))(e)?n(t,r):(t.disabled=!1,t.classList.remove(r.disabledButtonClass))},n=(e,t)=>{e.disabled=!0,e.classList.add(t.disabledButtonClass)},a=(e,t,o)=>{t.forEach((t=>{r(e,t,o)}))},s=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}editUserInfo(e){let{name:t,about:r}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}setUserAvatar(e){let{avatar:t}=e;return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}addCard(e){let{name:t,link:r}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:r})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}changeLikeStatus(e,t){const r=t?"DELETE":"PUT";return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:r,headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"a02b3a56-2aeb-4c2c-8ac4-78ecf247f130","Content-Type":"application/json"}}),c=document.querySelector(".profile__name"),i=document.querySelector(".profile__description"),l=document.querySelector(".profile__image"),d=document.querySelector(".profile__avatar-button"),u=document.querySelector(".profile__edit-button"),m=document.querySelector(".profile__add-button"),_=document.querySelectorAll(".modal"),h=document.querySelector("#edit-profile-modal"),f=document.querySelector("#new-post-modal"),v=document.querySelector("#edit-avatar-modal"),b=document.querySelector("#view-photo"),y=document.querySelector("#delete-card-modal"),p=document.querySelectorAll(".modal__close-btn"),S=document.forms["edit-profile-form"],q=document.querySelector("#name-input"),E=document.querySelector("#description-input"),k=document.forms["new-post-form"],L=f.querySelector("#caption-input"),g=f.querySelector("#image-link"),C=document.forms["edit-avatar"],$=document.querySelector("#avatar-link"),U=y.querySelector("form"),j=(U.querySelector('button[type="submit"]'),U.querySelector('button[type="button"]')),P=C.querySelector(".modal__submit-btn"),x=k.querySelector(".modal__submit-btn"),A=S.querySelector(".modal__submit-btn"),D=document.querySelector("#card-template").content,I=document.querySelector(".gallery__cards"),w=b.querySelector(".modal__image"),T=b.querySelector(".modal__caption");let B,N;function O(e){e.classList.add("modal_opened"),document.addEventListener("keydown",H)}function J(e){e.classList.remove("modal_opened"),document.removeEventListener("keydown",H)}function H(e){if("Escape"===e.key){const e=document.querySelector(".modal_opened");e&&J(e)}}function z(e){const t=D.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__image"),o=t.querySelector(".card__title"),n=t.querySelector(".card__like-button"),a=t.querySelector(".card__delete-button");return r.src=e.link,r.alt=e.name,o.textContent=e.name,e.isLiked&&n.classList.add("card__like-button_active"),n.addEventListener("click",(t=>function(e,t){const r=e.target.closest(".card__like-button"),o=r.classList.contains("card__like-button_active");s.changeLikeStatus(t,o).then((e=>{e.isLiked?r.classList.add("card__like-button_active"):r.classList.remove("card__like-button_active")})).catch(console.error)}(t,e._id))),a.addEventListener("click",(()=>function(e,t){B=e,N=t._id,O(y)}(t,e))),r.addEventListener("click",(()=>{O(b),w.src=e.link,T.textContent=e.name,T.alt=e.name})),t}var M;s.getAppInfo().then((e=>{let[t,r]=e;l.src=r.avatar,c.textContent=r.name,i.textContent=r.about,t.forEach((e=>{const t=z(e);I.append(t)}))})).catch(console.error),u.addEventListener("click",(function(){q.value=c.textContent,E.value=i.textContent,a(S,[q,E],t),O(h),n(A,t)})),m.addEventListener("click",(function(){O(f)})),d.addEventListener("click",(function(){a(C,[$],t),O(v),n(P,t)})),C.addEventListener("submit",(function(t){t.preventDefault();const r=t.submitter;e(r,!0),s.setUserAvatar({avatar:$.value}).then((e=>{document.querySelector(".profile__image").src=e.avatar,J(v),t.target.reset()})).catch(console.error).finally((()=>{e(r,!1)}))})),U.addEventListener("submit",(function(t){t.preventDefault();const r=t.submitter;e(r,!0,"Delete","Deleting..."),s.deleteCard(N).then((()=>{B.remove(),J(y)})).catch(console.error).finally((()=>{e(r,!1,"Delete","Deleting...")}))})),S.addEventListener("submit",(function(t){t.preventDefault();const r=t.submitter;e(r,!0),s.editUserInfo({name:q.value,about:E.value}).then((e=>{c.textContent=e.name,i.textContent=e.about,J(h)})).catch(console.error).finally((()=>{e(r,!1)}))})),k.addEventListener("submit",(function(r){r.preventDefault();const o=r.submitter;e(o,!0);const a={name:L.value,link:g.value};s.addCard(a).then((e=>{const o=z(e);I.prepend(o),r.target.reset(),n(x,t),J(f)})).catch(console.error).finally((()=>{e(o,!1)}))})),j.addEventListener("click",(()=>J(y))),_.forEach((e=>{e.addEventListener("mousedown",(t=>{t.target.classList.contains("modal_opened")&&J(e)}))})),p.forEach((e=>{const t=e.closest(".modal");e.addEventListener("click",(()=>J(t)))})),M=t,document.querySelectorAll(M.formSelector).forEach((e=>{((e,t)=>{const n=e.querySelectorAll(t.inputSelector),a=e.querySelector(t.submitButtonSelector);o(n,a,t),n.forEach((s=>{s.addEventListener("input",(function(){((e,t,o)=>{t.validity.valid?r(e,t,o):((e,t,r,o)=>{e.querySelector(`#${t.id}-error`).textContent=r,t.classList.add(o.inputErrorClass)})(e,t,t.validationMessage,o)})(e,s,t),o(n,a,t)}))}))})(e,M)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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bkgsRUFBT3VJLFFBQVEsVUFDN0J2SSxFQUFPb0gsaUJBQWlCLFNBQVMsSUFBTUUsRUFBV0gsSUFBTyxJRGxMakNqRyxFQ3VOVFYsRUR0TkV1RSxTQUFTTyxpQkFBaUJwRSxFQUFPVCxjQUN6QzZCLFNBQVN0QixJQWhCTTZJLEVBQUM3SSxFQUFhRSxLQUN0QyxNQUFNTyxFQUFZVCxFQUFZc0UsaUJBQWlCcEUsRUFBT1IsZUFDaERnQixFQUFnQlYsRUFBWUksY0FBY0YsRUFBT1Asc0JBRXZEYSxFQUFrQkMsRUFBV0MsRUFBZVIsR0FFNUNPLEVBQVVhLFNBQVNyQixJQUNqQkEsRUFBYW1HLGlCQUFpQixTQUFTLFdBOUNoQjBDLEVBQUM5SSxFQUFhQyxFQUFjQyxLQUNoREQsRUFBYWMsU0FBU0MsTUFRekJqQixFQUFlQyxFQUFhQyxFQUFjQyxHQXZCdkI2SSxFQUFDL0ksRUFBYUMsRUFBYytJLEVBQWM5SSxLQUN2Q0YsRUFBWUksY0FDbEMsSUFBSUgsRUFBYUksWUFFSGQsWUFBY3lKLEVBQzlCL0ksRUFBYUssVUFBVWMsSUFBSWxCLEVBQU9MLGdCQUFnQixFQVdoRGtKLENBQ0UvSSxFQUNBQyxFQUNBQSxFQUFhZ0osa0JBQ2IvSSxFQUlKLEVBcUNJNEksQ0FBbUI5SSxFQUFhQyxFQUFjQyxHQUM5Q00sRUFBa0JDLEVBQVdDLEVBQWVSLEVBQzlDLEdBQUUsR0FDRixFQU1BMkksQ0FBa0I3SSxFQUFhRSxFQUFPLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3V0aWxzL2hlbHBlcnMuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9zY3JpcHRzL3ZhbGlkYXRpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3V0aWxzL0FwaS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZnVuY3Rpb24gc2V0QnV0dG9uVGV4dChcbiAgYnV0dG9uLFxuICBpc0xvYWRpbmcsXG4gIGRlZmF1bHRUZXh0ID0gXCJTYXZlXCIsXG4gIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIlxuKSB7XG4gIGlmIChpc0xvYWRpbmcpIHtcbiAgICBidXR0b24udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcbiAgfSBlbHNlIHtcbiAgICBidXR0b24udGV4dENvbnRlbnQgPSBkZWZhdWx0VGV4dDtcbiAgfVxufVxuIiwiY29uc3Qgc2V0dGluZ3MgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc3VibWl0LWJ0blwiLFxuICBkaXNhYmxlZEJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zdWJtaXQtYnRuX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBhY3RpdmVFcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXG59O1xuXG5jb25zdCBzaG93SW5wdXRFcnJvciA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UsIGNvbmZpZykgPT4ge1xuICBjb25zdCBlcnJvck1zZ0VsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxuICApO1xuICBlcnJvck1zZ0VsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XG4gIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xufTtcblxuY29uc3QgaGlkZUlucHV0RXJyb3IgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKSA9PiB7XG4gIGNvbnN0IGVycm9yRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG4gIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG59O1xuXG5jb25zdCBjaGVja0lucHV0VmFsaWRpdHkgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKSA9PiB7XG4gIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgc2hvd0lucHV0RXJyb3IoXG4gICAgICBmb3JtRWxlbWVudCxcbiAgICAgIGlucHV0RWxlbWVudCxcbiAgICAgIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSxcbiAgICAgIGNvbmZpZ1xuICAgICk7XG4gIH0gZWxzZSB7XG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKTtcbiAgfVxufTtcblxuY29uc3QgaGFzSW52YWxpZElucHV0ID0gKGlucHV0TGlzdCkgPT4ge1xuICByZXR1cm4gQXJyYXkuZnJvbShpbnB1dExpc3QpLnNvbWUoKGlucHV0KSA9PiB7XG4gICAgcmV0dXJuICFpbnB1dC52YWxpZGl0eS52YWxpZDtcbiAgfSk7XG59O1xuXG5jb25zdCB0b2dnbGVCdXR0b25TdGF0ZSA9IChpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZykgPT4ge1xuICBpZiAoaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkpIHtcbiAgICBkaXNhYmxlQnV0dG9uKGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XG4gIH0gZWxzZSB7XG4gICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuZGlzYWJsZWRCdXR0b25DbGFzcyk7XG4gIH1cbn07XG5cbmNvbnN0IGRpc2FibGVCdXR0b24gPSAoYnV0dG9uRWxlbWVudCwgY29uZmlnKSA9PiB7XG4gIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xuICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQoY29uZmlnLmRpc2FibGVkQnV0dG9uQ2xhc3MpO1xufTtcblxuY29uc3QgcmVzZXRWYWxpZGF0aW9uID0gKGZvcm1FbGVtZW50LCBpbnB1dExpc3QsIGNvbmZpZykgPT4ge1xuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXQsIGNvbmZpZyk7XG4gIH0pO1xufTtcblxuY29uc3Qgc2V0RXZlbnRMaXN0ZW5lcnMgPSAoZm9ybUVsZW1lbnQsIGNvbmZpZykgPT4ge1xuICBjb25zdCBpbnB1dExpc3QgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5pbnB1dFNlbGVjdG9yKTtcbiAgY29uc3QgYnV0dG9uRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcblxuICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XG5cbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGNvbmZpZyk7XG4gICAgICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XG4gICAgfSk7XG4gIH0pO1xufTtcblxuY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChjb25maWcpID0+IHtcbiAgY29uc3QgZm9ybUxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpO1xuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xuICAgIHNldEV2ZW50TGlzdGVuZXJzKGZvcm1FbGVtZW50LCBjb25maWcpO1xuICB9KTtcbn07XG5cbmV4cG9ydCB7IGVuYWJsZVZhbGlkYXRpb24sIHJlc2V0VmFsaWRhdGlvbiwgZGlzYWJsZUJ1dHRvbiwgc2V0dGluZ3MgfTtcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi91dGlscy9BcGkuanNcIjtcbmltcG9ydCB7IHNldEJ1dHRvblRleHQgfSBmcm9tIFwiLi4vdXRpbHMvaGVscGVycy5qc1wiO1xuaW1wb3J0IHtcbiAgZW5hYmxlVmFsaWRhdGlvbixcbiAgcmVzZXRWYWxpZGF0aW9uLFxuICBkaXNhYmxlQnV0dG9uLFxuICBzZXR0aW5ncyxcbn0gZnJvbSBcIi4uL3NjcmlwdHMvdmFsaWRhdGlvbi5qc1wiO1xuXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCJhMDJiM2E1Ni0yYWViLTRjMmMtOGFjNC03OGVjZjI0N2YxMzBcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuXG4vLyBQcm9maWxlIGVsZW1lbnRzXG5jb25zdCBwcm9maWxlTmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb25FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIlxuKTtcbmNvbnN0IGF2YXRhckltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZVwiKTtcbmNvbnN0IGF2YXRhck1vZGFsQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXItYnV0dG9uXCIpO1xuY29uc3QgZWRpdFByb2ZpbGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xuY29uc3QgbmV3UG9zdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcblxuLy8gTW9kYWwgd2luZG93c1xuY29uc3QgbW9kYWxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbFwiKTtcbmNvbnN0IGVkaXRQcm9maWxlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtcHJvZmlsZS1tb2RhbFwiKTtcbmNvbnN0IG5ld1Bvc3RNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbmV3LXBvc3QtbW9kYWxcIik7XG5jb25zdCBhdmF0YXJNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1hdmF0YXItbW9kYWxcIik7XG5jb25zdCBwcmV2aWV3TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ZpZXctcGhvdG9cIik7XG5jb25zdCBkZWxldGVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZGVsZXRlLWNhcmQtbW9kYWxcIik7XG5jb25zdCBjbG9zZUJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XG5cbi8vIEZvcm1zIGFuZCBpbnB1dHNcbmNvbnN0IHByb2ZpbGVGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJlZGl0LXByb2ZpbGUtZm9ybVwiXTtcbmNvbnN0IG5hbWVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbmFtZS1pbnB1dFwiKTtcbmNvbnN0IGRlc2NyaXB0aW9uSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2Rlc2NyaXB0aW9uLWlucHV0XCIpO1xuY29uc3QgY2FyZEZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcIm5ldy1wb3N0LWZvcm1cIl07XG5jb25zdCBjYXJkTmFtZUlucHV0ID0gbmV3UG9zdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjY2FwdGlvbi1pbnB1dFwiKTtcbmNvbnN0IGNhcmRMaW5rSW5wdXQgPSBuZXdQb3N0TW9kYWwucXVlcnlTZWxlY3RvcihcIiNpbWFnZS1saW5rXCIpO1xuY29uc3QgYXZhdGFyRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wiZWRpdC1hdmF0YXJcIl07XG5jb25zdCBhdmF0YXJMaW5rSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2F2YXRhci1saW5rXCIpO1xuY29uc3QgZGVsZXRlRm9ybSA9IGRlbGV0ZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCJmb3JtXCIpO1xuY29uc3QgZGVsZXRlQnV0dG9uID0gZGVsZXRlRm9ybS5xdWVyeVNlbGVjdG9yKCdidXR0b25bdHlwZT1cInN1Ym1pdFwiXScpO1xuY29uc3QgY2FuY2VsQnV0dG9uID0gZGVsZXRlRm9ybS5xdWVyeVNlbGVjdG9yKCdidXR0b25bdHlwZT1cImJ1dHRvblwiXScpO1xuXG4vLyBGb3JtIHN1Ym1pdCBidXR0b25zXG5jb25zdCBhdmF0YXJGb3JtU3VibWl0QnV0dG9uID0gYXZhdGFyRm9ybS5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zdWJtaXQtYnRuXCIpO1xuY29uc3QgY2FyZEZvcm1TdWJtaXRCdXR0b24gPSBjYXJkRm9ybS5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zdWJtaXQtYnRuXCIpO1xuY29uc3QgcHJvZmlsZUZvcm1TdWJtaXRCdXR0b24gPSBwcm9maWxlRm9ybS5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zdWJtaXQtYnRuXCIpO1xuXG4vLyBDYXJkIGVsZW1lbnRzXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIikuY29udGVudDtcbmNvbnN0IGNhcmRMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5nYWxsZXJ5X19jYXJkc1wiKTtcbmNvbnN0IHByZXZpZXdNb2RhbEltYWdlRWwgPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XG5jb25zdCBwcmV2aWV3TW9kYWxDYXB0aW9uRWwgPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKTtcblxuLy8gU3RvcmUgdGhlIGN1cnJlbnQgc2VsZWN0ZWQgY2FyZCBhbmQgaXRzIElEXG5sZXQgc2VsZWN0ZWRDYXJkO1xubGV0IHNlbGVjdGVkQ2FyZElkO1xuXG5hcGlcbiAgLmdldEFwcEluZm8oKVxuICAudGhlbigoW2NhcmRzRGF0YSwgdXNlckRhdGFdKSA9PiB7XG4gICAgYXZhdGFySW1hZ2Uuc3JjID0gdXNlckRhdGEuYXZhdGFyO1xuICAgIHByb2ZpbGVOYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IHVzZXJEYXRhLm5hbWU7XG4gICAgcHJvZmlsZURlc2NyaXB0aW9uRWxlbWVudC50ZXh0Q29udGVudCA9IHVzZXJEYXRhLmFib3V0O1xuXG4gICAgY2FyZHNEYXRhLmZvckVhY2goKGNhcmREYXRhKSA9PiB7XG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGNhcmREYXRhKTtcbiAgICAgIGNhcmRMaXN0LmFwcGVuZChjYXJkRWxlbWVudCk7XG4gICAgfSk7XG4gIH0pXG4gIC5jYXRjaChjb25zb2xlLmVycm9yKTtcblxuLy8gT3BlbnMgYSBtb2RhbFxuZnVuY3Rpb24gb3Blbk1vZGFsKG1vZGFsKSB7XG4gIG1vZGFsLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGhhbmRsZUVzY0Nsb3NlKTtcbn1cblxuLy8gQ2xvc2VzIGEgbW9kYWxcbmZ1bmN0aW9uIGNsb3NlTW9kYWwobW9kYWwpIHtcbiAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlRXNjQ2xvc2UpO1xufVxuXG4vLyBPcGVucyBwcm9maWxlIGVkaXQgbW9kYWxcbmZ1bmN0aW9uIG9wZW5FZGl0UHJvZmlsZU1vZGFsKCkge1xuICBuYW1lSW5wdXQudmFsdWUgPSBwcm9maWxlTmFtZUVsZW1lbnQudGV4dENvbnRlbnQ7XG4gIGRlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSBwcm9maWxlRGVzY3JpcHRpb25FbGVtZW50LnRleHRDb250ZW50O1xuICByZXNldFZhbGlkYXRpb24ocHJvZmlsZUZvcm0sIFtuYW1lSW5wdXQsIGRlc2NyaXB0aW9uSW5wdXRdLCBzZXR0aW5ncyk7XG4gIG9wZW5Nb2RhbChlZGl0UHJvZmlsZU1vZGFsKTtcbiAgZGlzYWJsZUJ1dHRvbihwcm9maWxlRm9ybVN1Ym1pdEJ1dHRvbiwgc2V0dGluZ3MpO1xufVxuXG4vLyBPcGVucyBuZXcgcG9zdCBtb2RhbFxuZnVuY3Rpb24gb3Blbk5ld1Bvc3RNb2RhbCgpIHtcbiAgb3Blbk1vZGFsKG5ld1Bvc3RNb2RhbCk7XG59XG5cbi8vIE9wZW5zIGF2YXRhciBlZGl0IG1vZGFsXG5mdW5jdGlvbiBvcGVuQXZhdGFyTW9kYWwoKSB7XG4gIHJlc2V0VmFsaWRhdGlvbihhdmF0YXJGb3JtLCBbYXZhdGFyTGlua0lucHV0XSwgc2V0dGluZ3MpO1xuICBvcGVuTW9kYWwoYXZhdGFyTW9kYWwpO1xuICBkaXNhYmxlQnV0dG9uKGF2YXRhckZvcm1TdWJtaXRCdXR0b24sIHNldHRpbmdzKTtcbn1cblxuLy8gU3VibWl0cyBwcm9maWxlIGZvcm1cbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KGV2dCkge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3Qgc3VibWl0QnV0dG9uID0gZXZ0LnN1Ym1pdHRlcjtcbiAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdXR0b24sIHRydWUpO1xuXG4gIGFwaVxuICAgIC5lZGl0VXNlckluZm8oe1xuICAgICAgbmFtZTogbmFtZUlucHV0LnZhbHVlLFxuICAgICAgYWJvdXQ6IGRlc2NyaXB0aW9uSW5wdXQudmFsdWUsXG4gICAgfSlcbiAgICAudGhlbigodXNlckluZm8pID0+IHtcbiAgICAgIHByb2ZpbGVOYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IHVzZXJJbmZvLm5hbWU7XG4gICAgICBwcm9maWxlRGVzY3JpcHRpb25FbGVtZW50LnRleHRDb250ZW50ID0gdXNlckluZm8uYWJvdXQ7XG4gICAgICBjbG9zZU1vZGFsKGVkaXRQcm9maWxlTW9kYWwpO1xuICAgIH0pXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdXR0b24sIGZhbHNlKTtcbiAgICB9KTtcbn1cblxuLy8gU3VibWl0cyBuZXcgcG9zdCBmb3JtXG5mdW5jdGlvbiBoYW5kbGVOZXdQb3N0Rm9ybVN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IGV2dC5zdWJtaXR0ZXI7XG4gIHNldEJ1dHRvblRleHQoc3VibWl0QnV0dG9uLCB0cnVlKTtcblxuICBjb25zdCBjYXJkRGF0YSA9IHtcbiAgICBuYW1lOiBjYXJkTmFtZUlucHV0LnZhbHVlLFxuICAgIGxpbms6IGNhcmRMaW5rSW5wdXQudmFsdWUsXG4gIH07XG5cbiAgYXBpXG4gICAgLmFkZENhcmQoY2FyZERhdGEpXG4gICAgLnRoZW4oKG5ld0NhcmREYXRhKSA9PiB7XG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KG5ld0NhcmREYXRhKTtcbiAgICAgIGNhcmRMaXN0LnByZXBlbmQoY2FyZEVsZW1lbnQpO1xuICAgICAgZXZ0LnRhcmdldC5yZXNldCgpO1xuICAgICAgZGlzYWJsZUJ1dHRvbihjYXJkRm9ybVN1Ym1pdEJ1dHRvbiwgc2V0dGluZ3MpO1xuICAgICAgY2xvc2VNb2RhbChuZXdQb3N0TW9kYWwpO1xuICAgIH0pXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdXR0b24sIGZhbHNlKTtcbiAgICB9KTtcbn1cblxuLy8gU3VibWl0cyBhdmF0YXIgZm9ybVxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IGV2dC5zdWJtaXR0ZXI7XG4gIHNldEJ1dHRvblRleHQoc3VibWl0QnV0dG9uLCB0cnVlKTtcblxuICBhcGlcbiAgICAuc2V0VXNlckF2YXRhcih7XG4gICAgICBhdmF0YXI6IGF2YXRhckxpbmtJbnB1dC52YWx1ZSxcbiAgICB9KVxuICAgIC50aGVuKCh1c2VyRGF0YSkgPT4ge1xuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZVwiKS5zcmMgPSB1c2VyRGF0YS5hdmF0YXI7XG4gICAgICBjbG9zZU1vZGFsKGF2YXRhck1vZGFsKTtcbiAgICAgIGV2dC50YXJnZXQucmVzZXQoKTtcbiAgICB9KVxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHNldEJ1dHRvblRleHQoc3VibWl0QnV0dG9uLCBmYWxzZSk7XG4gICAgfSk7XG59XG5cbi8vIE9wZW5zIGRlbGV0ZSBjb25maXJtYXRpb24gbW9kYWxcbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNhcmQoY2FyZEVsZW1lbnQsIGRhdGEpIHtcbiAgc2VsZWN0ZWRDYXJkID0gY2FyZEVsZW1lbnQ7XG4gIHNlbGVjdGVkQ2FyZElkID0gZGF0YS5faWQ7XG4gIG9wZW5Nb2RhbChkZWxldGVNb2RhbCk7XG59XG5cbi8vIEhhbmRsZXMgZGVsZXRlIGNhcmQgc3VibWlzc2lvblxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlU3VibWl0KGV2dCkge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3Qgc3VibWl0QnV0dG9uID0gZXZ0LnN1Ym1pdHRlcjtcbiAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdXR0b24sIHRydWUsIFwiRGVsZXRlXCIsIFwiRGVsZXRpbmcuLi5cIik7XG5cbiAgYXBpXG4gICAgLmRlbGV0ZUNhcmQoc2VsZWN0ZWRDYXJkSWQpXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgc2VsZWN0ZWRDYXJkLnJlbW92ZSgpO1xuICAgICAgY2xvc2VNb2RhbChkZWxldGVNb2RhbCk7XG4gICAgfSlcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ1dHRvbiwgZmFsc2UsIFwiRGVsZXRlXCIsIFwiRGVsZXRpbmcuLi5cIik7XG4gICAgfSk7XG59XG5cbi8vIEhhbmRsZXMgbGlrZSBjYXJkIHN1Ym1pc3Npb25cbmZ1bmN0aW9uIGhhbmRsZUxpa2UoZXZ0LCBjYXJkSWQpIHtcbiAgY29uc3QgbGlrZUJ1dHRvbiA9IGV2dC50YXJnZXQuY2xvc2VzdChcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcbiAgY29uc3QgaXNMaWtlZCA9IGxpa2VCdXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuXG4gIGFwaVxuICAgIC5jaGFuZ2VMaWtlU3RhdHVzKGNhcmRJZCwgaXNMaWtlZClcbiAgICAudGhlbigodXBkYXRlZENhcmQpID0+IHtcbiAgICAgIGlmICh1cGRhdGVkQ2FyZC5pc0xpa2VkKSB7XG4gICAgICAgIGxpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICAgIH1cbiAgICB9KVxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKTtcbn1cblxuLy8gQWRkIGV2ZW50IGxpc3RlbmVyc1xuZWRpdFByb2ZpbGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9wZW5FZGl0UHJvZmlsZU1vZGFsKTtcbm5ld1Bvc3RCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9wZW5OZXdQb3N0TW9kYWwpO1xuYXZhdGFyTW9kYWxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9wZW5BdmF0YXJNb2RhbCk7XG5hdmF0YXJGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdCk7XG5kZWxldGVGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlRGVsZXRlU3VibWl0KTtcbnByb2ZpbGVGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQpO1xuY2FyZEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVOZXdQb3N0Rm9ybVN1Ym1pdCk7XG5jYW5jZWxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGNsb3NlTW9kYWwoZGVsZXRlTW9kYWwpKTtcblxuLy8gU2V0IHVwIG1vZGFsIGNsb3NlIGZ1bmN0aW9uYWxpdHlcbm1vZGFscy5mb3JFYWNoKChtb2RhbCkgPT4ge1xuICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldnQpID0+IHtcbiAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9vcGVuZWRcIikpIHtcbiAgICAgIGNsb3NlTW9kYWwobW9kYWwpO1xuICAgIH1cbiAgfSk7XG59KTtcblxuLy8gQ2xvc2VzIG1vZGFsIG9uIEVzY2FwZSBrZXlcbmZ1bmN0aW9uIGhhbmRsZUVzY0Nsb3NlKGV2dCkge1xuICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgIGNvbnN0IG9wZW5lZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9vcGVuZWRcIik7XG4gICAgaWYgKG9wZW5lZE1vZGFsKSB7XG4gICAgICBjbG9zZU1vZGFsKG9wZW5lZE1vZGFsKTtcbiAgICB9XG4gIH1cbn1cblxuY2xvc2VCdXR0b25zLmZvckVhY2goKGJ1dHRvbikgPT4ge1xuICBjb25zdCBtb2RhbCA9IGJ1dHRvbi5jbG9zZXN0KFwiLm1vZGFsXCIpO1xuICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGNsb3NlTW9kYWwobW9kYWwpKTtcbn0pO1xuXG4vLyBDcmVhdGVzIGEgY2FyZCBlbGVtZW50XG5mdW5jdGlvbiBnZXRDYXJkRWxlbWVudChkYXRhKSB7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZFRlbXBsYXRlLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKS5jbG9uZU5vZGUodHJ1ZSk7XG4gIGNvbnN0IGNhcmRJbWFnZSA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG4gIGNvbnN0IGNhcmRUaXRsZSA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XG4gIGNvbnN0IGNhcmRMaWtlQnRuID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcbiAgY29uc3QgY2FyZERlbGV0ZUJ0biA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKTtcblxuICAvLyBTZXQgY2FyZCBjb250ZW50XG4gIGNhcmRJbWFnZS5zcmMgPSBkYXRhLmxpbms7XG4gIGNhcmRJbWFnZS5hbHQgPSBkYXRhLm5hbWU7XG4gIGNhcmRUaXRsZS50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcblxuICAvLyBTZXQgaW5pdGlhbCBsaWtlIHN0YXRlIGJhc2VkIG9uIHRoZSBpc0xpa2VkIHByb3BlcnR5IGRpcmVjdGx5XG4gIGlmIChkYXRhLmlzTGlrZWQpIHtcbiAgICBjYXJkTGlrZUJ0bi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICB9XG5cbiAgLy8gQWRkIGV2ZW50IGxpc3RlbmVyc1xuICBjYXJkTGlrZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4gaGFuZGxlTGlrZShldnQsIGRhdGEuX2lkKSk7XG4gIGNhcmREZWxldGVCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XG4gICAgaGFuZGxlRGVsZXRlQ2FyZChjYXJkRWxlbWVudCwgZGF0YSlcbiAgKTtcblxuICBjYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBvcGVuTW9kYWwocHJldmlld01vZGFsKTtcbiAgICBwcmV2aWV3TW9kYWxJbWFnZUVsLnNyYyA9IGRhdGEubGluaztcbiAgICBwcmV2aWV3TW9kYWxDYXB0aW9uRWwudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG4gICAgcHJldmlld01vZGFsQ2FwdGlvbkVsLmFsdCA9IGRhdGEubmFtZTtcbiAgfSk7XG4gIHJldHVybiBjYXJkRWxlbWVudDtcbn1cblxuLy8gSW5pdGlhbGl6ZSB2YWxpZGF0aW9uIHdpdGggc2V0dGluZ3NcbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xuIiwiY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcbiAgfVxuXG4gIGdldEFwcEluZm8oKSB7XG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldEluaXRpYWxDYXJkcygpLCB0aGlzLmdldFVzZXJJbmZvKCldKTtcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgZWRpdFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgbmFtZSwgYWJvdXQgfSksXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgc2V0VXNlckF2YXRhcih7IGF2YXRhciB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgYXZhdGFyIH0pLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgYWRkQ2FyZCh7IG5hbWUsIGxpbmsgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lLCBsaW5rIH0pLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxuXG4gIGNoYW5nZUxpa2VTdGF0dXMoY2FyZElkLCBpc0xpa2VkKSB7XG4gICAgY29uc3QgbWV0aG9kID0gaXNMaWtlZCA/IFwiREVMRVRFXCIgOiBcIlBVVFwiO1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IG1ldGhvZCxcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEFwaTtcbiJdLCJuYW1lcyI6WyJzZXRCdXR0b25UZXh0IiwiYnV0dG9uIiwiaXNMb2FkaW5nIiwiZGVmYXVsdFRleHQiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJsb2FkaW5nVGV4dCIsInRleHRDb250ZW50Iiwic2V0dGluZ3MiLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJkaXNhYmxlZEJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiYWN0aXZlRXJyb3JDbGFzcyIsImhpZGVJbnB1dEVycm9yIiwiZm9ybUVsZW1lbnQiLCJpbnB1dEVsZW1lbnQiLCJjb25maWciLCJlcnJvckVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiaWQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImlucHV0TGlzdCIsImJ1dHRvbkVsZW1lbnQiLCJBcnJheSIsImZyb20iLCJzb21lIiwiaW5wdXQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiaGFzSW52YWxpZElucHV0IiwiZGlzYWJsZUJ1dHRvbiIsImRpc2FibGVkIiwiYWRkIiwicmVzZXRWYWxpZGF0aW9uIiwiZm9yRWFjaCIsImFwaSIsImNvbnN0cnVjdG9yIiwiX3JlZiIsImJhc2VVcmwiLCJoZWFkZXJzIiwidGhpcyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJnZXRBcHBJbmZvIiwiUHJvbWlzZSIsImFsbCIsImdldEluaXRpYWxDYXJkcyIsImdldFVzZXJJbmZvIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwicmVqZWN0Iiwic3RhdHVzIiwiZWRpdFVzZXJJbmZvIiwiX3JlZjIiLCJuYW1lIiwiYWJvdXQiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInNldFVzZXJBdmF0YXIiLCJfcmVmMyIsImF2YXRhciIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJhZGRDYXJkIiwiX3JlZjQiLCJsaW5rIiwiY2hhbmdlTGlrZVN0YXR1cyIsImlzTGlrZWQiLCJhdXRob3JpemF0aW9uIiwicHJvZmlsZU5hbWVFbGVtZW50IiwiZG9jdW1lbnQiLCJwcm9maWxlRGVzY3JpcHRpb25FbGVtZW50IiwiYXZhdGFySW1hZ2UiLCJhdmF0YXJNb2RhbEJ1dHRvbiIsImVkaXRQcm9maWxlQnV0dG9uIiwibmV3UG9zdEJ1dHRvbiIsIm1vZGFscyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJlZGl0UHJvZmlsZU1vZGFsIiwibmV3UG9zdE1vZGFsIiwiYXZhdGFyTW9kYWwiLCJwcmV2aWV3TW9kYWwiLCJkZWxldGVNb2RhbCIsImNsb3NlQnV0dG9ucyIsInByb2ZpbGVGb3JtIiwiZm9ybXMiLCJuYW1lSW5wdXQiLCJkZXNjcmlwdGlvbklucHV0IiwiY2FyZEZvcm0iLCJjYXJkTmFtZUlucHV0IiwiY2FyZExpbmtJbnB1dCIsImF2YXRhckZvcm0iLCJhdmF0YXJMaW5rSW5wdXQiLCJkZWxldGVGb3JtIiwiY2FuY2VsQnV0dG9uIiwiYXZhdGFyRm9ybVN1Ym1pdEJ1dHRvbiIsImNhcmRGb3JtU3VibWl0QnV0dG9uIiwicHJvZmlsZUZvcm1TdWJtaXRCdXR0b24iLCJjYXJkVGVtcGxhdGUiLCJjb250ZW50IiwiY2FyZExpc3QiLCJwcmV2aWV3TW9kYWxJbWFnZUVsIiwicHJldmlld01vZGFsQ2FwdGlvbkVsIiwic2VsZWN0ZWRDYXJkIiwic2VsZWN0ZWRDYXJkSWQiLCJvcGVuTW9kYWwiLCJtb2RhbCIsImFkZEV2ZW50TGlzdGVuZXIiLCJoYW5kbGVFc2NDbG9zZSIsImNsb3NlTW9kYWwiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZ0Iiwia2V5Iiwib3BlbmVkTW9kYWwiLCJnZXRDYXJkRWxlbWVudCIsImRhdGEiLCJjYXJkRWxlbWVudCIsImNsb25lTm9kZSIsImNhcmRJbWFnZSIsImNhcmRUaXRsZSIsImNhcmRMaWtlQnRuIiwiY2FyZERlbGV0ZUJ0biIsInNyYyIsImFsdCIsImxpa2VCdXR0b24iLCJ0YXJnZXQiLCJjbG9zZXN0IiwiY29udGFpbnMiLCJ1cGRhdGVkQ2FyZCIsImNhdGNoIiwiY29uc29sZSIsImVycm9yIiwiaGFuZGxlTGlrZSIsIl9pZCIsImhhbmRsZURlbGV0ZUNhcmQiLCJjYXJkc0RhdGEiLCJ1c2VyRGF0YSIsImNhcmREYXRhIiwiYXBwZW5kIiwidmFsdWUiLCJwcmV2ZW50RGVmYXVsdCIsInN1Ym1pdEJ1dHRvbiIsInN1Ym1pdHRlciIsInJlc2V0IiwiZmluYWxseSIsInVzZXJJbmZvIiwibmV3Q2FyZERhdGEiLCJwcmVwZW5kIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJjaGVja0lucHV0VmFsaWRpdHkiLCJzaG93SW5wdXRFcnJvciIsImVycm9yTWVzc2FnZSIsInZhbGlkYXRpb25NZXNzYWdlIl0sInNvdXJjZVJvb3QiOiIifQ==